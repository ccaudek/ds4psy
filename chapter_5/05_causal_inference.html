

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Inferenza causale &#8212; ds4p</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-VMXNE4BCDL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-VMXNE4BCDL');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter_5/05_causal_inference';</script>
    <link rel="canonical" href="https://ccaudek.github.io/ds4psy/chapter_5/05_causal_inference.html" />
    <link rel="shortcut icon" href="../_static/increasing.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="✏️ Esercizi" href="E_causal_inference.html" />
    <link rel="prev" title="Confronto tra le medie di due gruppi" href="05_reglin_4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ds4p - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ds4p - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_1/introduction_chapter_1.html">Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/01_python_1.html">Python (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/02_python_2.html">Python (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_python.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/03_numpy.html">NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_numpy.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/04_pandas.html">Pandas (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/05_pandas_aggregate.html">Pandas (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/06_pandas_functions.html">Pandas (3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_pandas.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/07_matplotlib.html">Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/08_seaborn.html">Seaborn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_1/ex_matplotlib.html">✏️ Esercizi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_2/introduction_chapter_2.html">Statistica descrittiva</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/01_key_notions.html">Concetti chiave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_key_notions.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/02_measurement.html">La misurazione in psicologia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_scales.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/03_freq_distr.html">Dati e frequenze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_sums.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/04_loc_scale.html">Indici di posizione e di scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/05_correlation.html">Le relazioni tra variabili</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/06_causality.html">Correlazione e causazione</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/07_crisis.html">La crisi della generalizzabilità</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_eda.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_2/E_mehr_song_spelke.html">✏️ Esercizi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_3/introduction_chapter_3.html">Probabilità</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/01_intro_prob.html">Introduzione al calcolo delle probabilità</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_prob.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/02_conditional_prob.html">Probabilità condizionata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_cond_prob.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/03_bayes_theorem.html">Il teorema di Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_bayes_theorem.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04_expval_var.html">Proprietà delle variabili casuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04a_sampling_distr.html">Stime, stimatori e parametri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/04b_illusion.html">Incertezza inferenziale e variabilità dei risultati</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_rv_discrete.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/05_joint_prob.html">Probabilità congiunta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_joint_prob.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/06_density_func.html">La funzione di densità di probabilità</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/07_discr_rv_distr.html">Distribuzioni di v.c. discrete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_binomial.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/08_cont_rv_distr.html">Distribuzioni di v.c. continue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_gaussian.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_beta_distr.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/09_likelihood.html">La verosimiglianza</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/10_rescorla_wagner.html">Apprendimento per rinforzo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_3/E_likelihood.html">✏️ Esercizi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_4/introduction_part_4.html">Inferenza bayesiana</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/01_intro_bayes.html">Modellazione bayesiana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/01a_models.html">Modelli scientifici</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/02_subj_prop.html">Pensare ad una proporzione in termini soggettivi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/03_conjugate_families_1.html">Distribuzioni coniugate (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/04_conjugate_families_2.html">Distribuzioni coniugate (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/05_summary_posterior.html">Sintesi a posteriori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_conjugate.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/06_balance-prior-post.html">L’influenza della distribuzione a priori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/10_metropolis.html">Monte Carlo a Catena di Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/11_beta_binomial_pymc.html">Inferenza bayesiana con PyMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/12_jax.html">Usare JAX per un campionamento più veloce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/16_summary_posterior_pymc.html">Metodi di sintesi della distribuzione a posteriori</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/17_prediction.html">La predizione bayesiana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/18_mcmc_diagnostics.html">Diagnostica delle catene markoviane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/19_odds_ratio.html">Analisi bayesiana dell’odds-ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/20_poisson_model.html">Modello di Poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/21_poisson_sim.html">Modello di Poisson: derivazione analitica e MCMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_freq.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/22_normal_normal_model.html">Inferenza bayesiana su una media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_one_mean.html">✏️ Esercizio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/E_one_mean_2.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/23_two_groups.html">Confronto tra due gruppi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/24_multiple_groups.html">Gruppi multipli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/30_entropy.html">Entropia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/31_kl.html">La divergenza di Kullback-Leibler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/32_loo.html">Validazione Incrociata Leave-One-Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/40_hier_beta_binom.html">Modello gerarchico beta-binomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/41_hier_poisson.html">Modello gerarchico di Poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/42_hier_gaussian.html">Modello gerarchico gaussiano</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_4/45_missing.html">1. Perdita di Dati Casuale e Indipendente dalle Cause</a></li>


<li class="toctree-l2"><a class="reference internal" href="../chapter_4/hssm.html">Drift Diffusion Model</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="introduction_part_5.html">Analisi della regressione</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="05_reglin_1.html">Il modello di regressione lineare</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_reglin_2.html">Analisi bayesiana del modello di regressione lineare</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_params_recovery.html">Analisi di simulazione per la stima dei parametri nel modello di regressione</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_reglin_3.html">Zucchero sintattico</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_reglin_4.html">Confronto tra le medie di due gruppi</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Inferenza causale</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_causal_inference.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_reglin_5.html">Il modello lineare gerarchico</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_reglin_7.html">Regressione robusta</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_simpson.html">Paradosso di Simpson</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_1.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_2.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_3.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="E_reglin_4.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_logistic_reg.html">Modello di regressione logistica</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_binomial_reg.html">Regressione binomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_covid.html">Inferenza controfattuale</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_counterfactual.html">Analisi causale con PyMC</a></li>

<li class="toctree-l2"><a class="reference internal" href="E_stab.html">✏️ Esercizi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_6/introduction_part_6.html">Inferenza frequentista</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_estimation.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/02_conf_interv.html">Intervallo di confidenza</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/03_test_ipotesi.html">Significatività statistica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_interpretation_test.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_significato_test.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/04_two_ind_samples.html">Test t di Student per campioni indipendenti</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_test_media_pop.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_medie_pop_ampie.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_medie_pop_piccoli.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_campioni_appaiati.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/E_confronto_proporzioni.html">✏️ Esercizi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/05_limiti_stat_frequentista.html">Limiti dell’inferenza frequentista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_6/06_s_m_errors.html">Crisi della replicabilità</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references/bibliography.html">Bibliografia</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter_7/introduction_appendix.html">Appendici</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a00_installation.html">Ambiente di lavoro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a01_markdown.html">Jupyter Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a02_shell.html">La Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a03_virtual_env.html">Ambiente virtuale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a10_math_symbols.html">Simbologia di base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a11_numbers.html">Numeri binari, interi, razionali, irrazionali e reali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a12_sum_notation.html">Simbolo di somma (sommatorie)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a13_sets.html">Insiemi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a14_combinatorics.html">Calcolo combinatorio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a15_calculus.html">Per liberarvi dai terrori preliminari</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a20_kde_plot.html">Kernel Density Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a30_prob_tutorial.html">Esercizi di probabilità discreta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a40_rng.html">Generazione di numeri casuali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a44_montecarlo.html">Simulazione Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a45_mcmc.html">Catene di Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a50_lin_fun.html">La funzione lineare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a51_reglin_1.html">Regressione lineare bivariata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a52_reglin_2.html">Regressione lineare con Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a53_reglin_4.html">Posterior Predictive Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a60_ttest_exercises.html">Esercizi sull’inferenza frequentista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_7/a70_predict_counts.html">La predizione delle frequenze</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/ccaudek/ds4psy/blob/main/docs/chapter_5/05_causal_inference.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter_5/05_causal_inference.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inferenza causale</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-del-notebook">Preparazione del Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-e-analisi-causale">Modello di Regressione e Analisi Causale</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-1-catena">Esempio 1: Catena</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-2-biforcazione">Esempio 2: Biforcazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-3-il-condizionamento-produce-una-distorsione">Esempio 3: Il Condizionamento Produce una Distorsione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conlusive">Considerazioni Conlusive</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#l-inferenza-causale-non-e-solo-un-problema-statistico">L’inferenza causale non è solo un problema statistico</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><a target="_blank" rel="noopener noreferrer" href="https://colab.research.google.com/github/ccaudek/ds4psy_2023/blob/main/415_reglin_4.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="inferenza-causale">
<span id="causal-inference-notebook"></span><h1>Inferenza causale<a class="headerlink" href="#inferenza-causale" title="Permalink to this heading">#</a></h1>
<p>Lo scopo di questo capitolo è di introdurre il modello di regressione multipla e di discutere come esso si collega all’analisi causale.</p>
<section id="preparazione-del-notebook">
<h2>Preparazione del Notebook<a class="headerlink" href="#preparazione-del-notebook" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">bambi</span> <span class="k">as</span> <span class="nn">bmb</span>
<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">from</span> <span class="nn">pymc</span> <span class="kn">import</span> <span class="n">HalfNormal</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">sample</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">Warning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NoSectionError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/configparser.py:202,</span> in <span class="ni">PyTensorConfigParser.fetch_val_for_key</span><span class="nt">(self, key, delete_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">202</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pytensor_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span> <span class="k">except</span> <span class="n">InterpolationError</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/configparser.py:797,</span> in <span class="ni">RawConfigParser.get</span><span class="nt">(self, section, option, raw, vars, fallback)</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">797</span>     <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unify_values</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span> <span class="k">except</span> <span class="n">NoSectionError</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/configparser.py:1168,</span> in <span class="ni">RawConfigParser._unify_values</span><span class="nt">(self, section, vars)</span>
<span class="g g-Whitespace">   </span><span class="mi">1167</span>     <span class="k">if</span> <span class="n">section</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_section</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1168</span>         <span class="k">raise</span> <span class="n">NoSectionError</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1169</span> <span class="c1"># Update with the entry specific variables</span>

<span class="ne">NoSectionError</span>: No section: &#39;blas&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/configparser.py:318,</span> in <span class="ni">ConfigParam.__get__</span><span class="nt">(self, cls, type_, delete_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">318</span>     <span class="n">val_str</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fetch_val_for_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">delete_key</span><span class="o">=</span><span class="n">delete_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>     <span class="bp">self</span><span class="o">.</span><span class="n">is_default</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/configparser.py:206,</span> in <span class="ni">PyTensorConfigParser.fetch_val_for_key</span><span class="nt">(self, key, delete_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span> <span class="k">except</span> <span class="p">(</span><span class="n">NoOptionError</span><span class="p">,</span> <span class="n">NoSectionError</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">206</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;blas__ldflags&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">st</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">import</span> <span class="nn">bambi</span> <span class="k">as</span> <span class="nn">bmb</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">pymc</span> <span class="kn">import</span> <span class="n">HalfNormal</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">sample</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">bambi</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">logging</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">pymc</span> <span class="kn">import</span> <span class="n">math</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">.backend</span> <span class="kn">import</span> <span class="n">PyMCModel</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">.data</span> <span class="kn">import</span> <span class="n">clear_data_home</span><span class="p">,</span> <span class="n">load_data</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pymc</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">47</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="n">augmented</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">augmented</span><span class="si">}</span><span class="s2"> -fno-unwind-tables -fno-asynchronous-unwind-tables&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>     <span class="n">pytensor</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">gcc__cxxflags</span> <span class="o">=</span> <span class="n">augmented</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">__set_compiler_flags</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span> <span class="kn">from</span> <span class="nn">pymc</span> <span class="kn">import</span> <span class="n">_version</span><span class="p">,</span> <span class="n">gp</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">sampling</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="kn">from</span> <span class="nn">pymc.backends</span> <span class="kn">import</span> <span class="o">*</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pymc/__init__.py:30,</span> in <span class="ni">__set_compiler_flags</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="k">def</span> <span class="nf">__set_compiler_flags</span><span class="p">():</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span>     <span class="c1"># Workarounds for PyTensor compiler problems on various platforms</span>
<span class="ne">---&gt; </span><span class="mi">30</span>     <span class="kn">import</span> <span class="nn">pytensor</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="n">current</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">gcc__cxxflags</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="n">augmented</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2"> -Wno-c++11-narrowing&quot;</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">119</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="k">return</span> <span class="n">as_tensor_variable</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span> <span class="c1"># isort: off</span>
<span class="ne">--&gt; </span><span class="mi">119</span> <span class="kn">from</span> <span class="nn">pytensor</span> <span class="kn">import</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">tensor</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span> <span class="kn">from</span> <span class="nn">pytensor.compile</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>     <span class="n">In</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span>     <span class="n">Mode</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>     <span class="n">shared</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="kn">from</span> <span class="nn">pytensor.compile.function</span> <span class="kn">import</span> <span class="n">function</span><span class="p">,</span> <span class="n">function_dump</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">tensor</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">107</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="c1"># adds shared-variable constructors</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> <span class="kn">from</span> <span class="nn">pytensor.tensor</span> <span class="kn">import</span> <span class="n">sharedvar</span>  <span class="c1"># noqa</span>
<span class="ne">--&gt; </span><span class="mi">107</span> <span class="kn">from</span> <span class="nn">pytensor.tensor</span> <span class="kn">import</span> <span class="p">(</span>  <span class="c1"># noqa</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="n">blas</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="n">blas_c</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>     <span class="n">blas_scipy</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span>     <span class="n">xlogx</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span> <span class="kn">import</span> <span class="nn">pytensor.tensor.rewriting</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span> <span class="c1"># isort: off</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">tensor</span><span class="o">/</span><span class="n">blas</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">102</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span> <span class="kn">from</span> <span class="nn">pytensor.tensor</span> <span class="kn">import</span> <span class="n">basic</span> <span class="k">as</span> <span class="n">ptb</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> <span class="kn">from</span> <span class="nn">pytensor.tensor.basic</span> <span class="kn">import</span> <span class="n">expand_dims</span>
<span class="ne">--&gt; </span><span class="mi">102</span> <span class="kn">from</span> <span class="nn">pytensor.tensor.blas_headers</span> <span class="kn">import</span> <span class="n">blas_header_text</span><span class="p">,</span> <span class="n">blas_header_version</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span> <span class="kn">from</span> <span class="nn">pytensor.tensor.elemwise</span> <span class="kn">import</span> <span class="n">DimShuffle</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span> <span class="kn">from</span> <span class="nn">pytensor.tensor.math</span> <span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">neg</span><span class="p">,</span> <span class="n">sub</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">pymc_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">tensor</span><span class="o">/</span><span class="n">blas_headers</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1015</span>
<span class="g g-Whitespace">    </span><span class="mi">997</span>             <span class="n">header</span> <span class="o">+=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">998</span><span class="w">                 </span><span class="sd">&quot;&quot;&quot;\</span>
<span class="g g-Whitespace">    </span><span class="mi">999</span><span class="sd">                     static float sdot_(int* Nx, float* x, int* Sx, float* y, int* Sy)</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span><span class="sd">                     &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1010</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1012</span>     <span class="k">return</span> <span class="n">header</span> <span class="o">+</span> <span class="n">blas_code</span>
<span class="ne">-&gt; </span><span class="mi">1015</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">blas__ldflags</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1016</span>     <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Using NumPy C-API based implementation for BLAS functions.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1019</span> <span class="k">def</span> <span class="nf">mkl_threads_text</span><span class="p">():</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/configparser.py:322,</span> in <span class="ni">ConfigParam.__get__</span><span class="nt">(self, cls, type_, delete_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>     <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">322</span>         <span class="n">val_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>         <span class="n">val_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2861,</span> in <span class="ni">default_blas_ldflags</span><span class="nt">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2859</span>     <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking Lapack + blas&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2860</span>     <span class="c1"># 3. Try to use LAPACK + BLAS</span>
<span class="ne">-&gt; </span><span class="mi">2861</span>     <span class="k">return</span> <span class="n">check_libs</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2862</span>         <span class="n">all_libs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2863</span>         <span class="n">required_libs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lapack&quot;</span><span class="p">,</span> <span class="s2">&quot;blas&quot;</span><span class="p">,</span> <span class="s2">&quot;cblas&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">   </span><span class="mi">2864</span>         <span class="n">extra_compile_flags</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;-Wl,-rpath,</span><span class="si">{</span><span class="n">rpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">rpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
<span class="g g-Whitespace">   </span><span class="mi">2865</span>         <span class="n">cxx_library_dirs</span><span class="o">=</span><span class="n">cxx_library_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2866</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2867</span> <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2868</span>     <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2780,</span> in <span class="ni">default_blas_ldflags.&lt;locals&gt;.check_libs</span><span class="nt">(all_libs, required_libs, extra_compile_flags, cxx_library_dirs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2765</span> <span class="n">libdir_ldflags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2766</span>     <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2767</span>         <span class="p">[</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2772</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2773</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2775</span> <span class="n">flags</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2776</span>     <span class="n">libdir_ldflags</span>
<span class="g g-Whitespace">   </span><span class="mi">2777</span>     <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;-l</span><span class="si">{</span><span class="n">lib_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">lib_name</span> <span class="ow">in</span> <span class="n">found_libs</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2778</span>     <span class="o">+</span> <span class="n">extra_compile_flags</span>
<span class="g g-Whitespace">   </span><span class="mi">2779</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2780</span> <span class="n">res</span> <span class="o">=</span> <span class="n">try_blas_flag</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2781</span> <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2782</span>     <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot;mkl&quot;</span> <span class="ow">in</span> <span class="n">flag</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">):</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:1997,</span> in <span class="ni">try_blas_flag</span><span class="nt">(flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1994</span> <span class="n">path_wrapper</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<span class="nn">   1995 cflags.extend([f&quot;-L{path_wrapper}{d}{path_wrapper}&quot; for d</span> in <span class="ni">std_lib_dirs</span><span class="nt">()])</span>
<span class="ne">-&gt; </span><span class="mi">1997</span> <span class="n">res</span> <span class="o">=</span> <span class="n">GCC_compiler</span><span class="o">.</span><span class="n">try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1998</span>     <span class="n">test_code</span><span class="p">,</span> <span class="n">tmp_prefix</span><span class="o">=</span><span class="s2">&quot;try_blas_&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">cflags</span><span class="p">,</span> <span class="n">try_run</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">   </span><span class="mi">1999</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2000</span> <span class="c1"># res[0]: shows successful compilation</span>
<span class="g g-Whitespace">   </span><span class="mi">2001</span> <span class="c1"># res[1]: shows successful execution</span>
<span class="g g-Whitespace">   </span><span class="mi">2002</span> <span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2393,</span> in <span class="ni">GCC_compiler.try_compile_tmp</span><span class="nt">(cls, src_code, tmp_prefix, flags, try_run, output, comp_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">2383</span> <span class="nd">@classmethod</span>
<span class="g g-Whitespace">   </span><span class="mi">2384</span> <span class="k">def</span> <span class="nf">try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2385</span>     <span class="bp">cls</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2391</span>     <span class="n">comp_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2392</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2393</span>     <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2394</span>         <span class="n">src_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2395</span>         <span class="n">tmp_prefix</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span>         <span class="bp">cls</span><span class="o">.</span><span class="n">patch_ldflags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">2397</span>         <span class="n">try_run</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2398</span>         <span class="n">output</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2399</span>         <span class="n">config</span><span class="o">.</span><span class="n">cxx</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2400</span>         <span class="n">comp_args</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2401</span>     <span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:1872,</span> in <span class="ni">Compiler._try_compile_tmp</span><span class="nt">(cls, src_code, tmp_prefix, flags, try_run, output, compiler, comp_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1870</span> <span class="c1"># Get compile arguments from compiler method if required</span>
<span class="g g-Whitespace">   </span><span class="mi">1871</span> <span class="k">if</span> <span class="n">comp_args</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1872</span>     <span class="n">args</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compile_args</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1873</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1874</span>     <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2313,</span> in <span class="ni">GCC_compiler.compile_args</span><span class="nt">(march_flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">2311</span> <span class="n">march_flags_to_try</span> <span class="o">=</span> <span class="n">default_detected_flag</span> <span class="o">+</span> <span class="n">march_flags_to_try</span>
<span class="g g-Whitespace">   </span><span class="mi">2312</span> <span class="k">for</span> <span class="n">march_flag</span> <span class="ow">in</span> <span class="n">march_flags_to_try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2313</span>     <span class="n">compilation_result</span><span class="p">,</span> <span class="n">execution_result</span> <span class="o">=</span> <span class="n">try_march_flag</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2314</span>         <span class="p">[</span><span class="s2">&quot;-march=&quot;</span> <span class="o">+</span> <span class="n">march_flag</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2315</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2316</span>     <span class="k">if</span> <span class="n">compilation_result</span> <span class="ow">and</span> <span class="n">execution_result</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2317</span>         <span class="n">march_success</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2032,</span> in <span class="ni">try_march_flag</span><span class="nt">(flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">2013</span> <span class="n">test_code</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2014</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;\</span>
<span class="g g-Whitespace">   </span><span class="mi">2015</span><span class="sd">         #include &lt;cmath&gt;</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">2028</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2029</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2031</span> <span class="n">cflags</span> <span class="o">=</span> <span class="n">flags</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;-L&quot;</span> <span class="o">+</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">std_lib_dirs</span><span class="p">()]</span>
<span class="ne">-&gt; </span><span class="mi">2032</span> <span class="n">compilation_result</span><span class="p">,</span> <span class="n">execution_result</span> <span class="o">=</span> <span class="n">GCC_compiler</span><span class="o">.</span><span class="n">try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2033</span>     <span class="n">test_code</span><span class="p">,</span> <span class="n">tmp_prefix</span><span class="o">=</span><span class="s2">&quot;try_march_&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">cflags</span><span class="p">,</span> <span class="n">try_run</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">   </span><span class="mi">2034</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2035</span> <span class="k">return</span> <span class="n">compilation_result</span><span class="p">,</span> <span class="n">execution_result</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:2393,</span> in <span class="ni">GCC_compiler.try_compile_tmp</span><span class="nt">(cls, src_code, tmp_prefix, flags, try_run, output, comp_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">2383</span> <span class="nd">@classmethod</span>
<span class="g g-Whitespace">   </span><span class="mi">2384</span> <span class="k">def</span> <span class="nf">try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2385</span>     <span class="bp">cls</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2391</span>     <span class="n">comp_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2392</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2393</span>     <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_try_compile_tmp</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2394</span>         <span class="n">src_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2395</span>         <span class="n">tmp_prefix</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span>         <span class="bp">cls</span><span class="o">.</span><span class="n">patch_ldflags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">2397</span>         <span class="n">try_run</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2398</span>         <span class="n">output</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2399</span>         <span class="n">config</span><span class="o">.</span><span class="n">cxx</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2400</span>         <span class="n">comp_args</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2401</span>     <span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/link/c/cmodule.py:1898,</span> in <span class="ni">Compiler._try_compile_tmp</span><span class="nt">(cls, src_code, tmp_prefix, flags, try_run, output, compiler, comp_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1896</span>         <span class="n">compilation_ok</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">   </span><span class="mi">1897</span>     <span class="k">elif</span> <span class="n">try_run</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1898</span>         <span class="n">out</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">p_ret</span> <span class="o">=</span> <span class="n">output_subprocess_Popen</span><span class="p">([</span><span class="n">exe_path</span><span class="p">])</span>
<span class="g g-Whitespace">   </span><span class="mi">1899</span>         <span class="n">run_ok</span> <span class="o">=</span> <span class="n">p_ret</span> <span class="o">==</span> <span class="mi">0</span>
<span class="g g-Whitespace">   </span><span class="mi">1900</span> <span class="k">finally</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/site-packages/pytensor/utils.py:212,</span> in <span class="ni">output_subprocess_Popen</span><span class="nt">(command, **params)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span> <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess_Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span> <span class="c1"># we need to use communicate to make sure we don&#39;t deadlock around</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span> <span class="c1"># the stdout/stderr pipe.</span>
<span class="ne">--&gt; </span><span class="mi">212</span> <span class="n">out</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span> <span class="k">return</span> <span class="n">out</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">returncode</span><span class="p">,)</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/subprocess.py:1209,</span> in <span class="ni">Popen.communicate</span><span class="nt">(self, input, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1206</span>     <span class="n">endtime</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1208</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1209</span>     <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_communicate</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1210</span> <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1211</span>     <span class="c1"># https://bugs.python.org/issue25942</span>
<span class="g g-Whitespace">   </span><span class="mi">1212</span>     <span class="c1"># See the detailed comment in .wait().</span>
<span class="g g-Whitespace">   </span><span class="mi">1213</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/subprocess.py:2108,</span> in <span class="ni">Popen._communicate</span><span class="nt">(self, input, endtime, orig_timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">2101</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_timeout</span><span class="p">(</span><span class="n">endtime</span><span class="p">,</span> <span class="n">orig_timeout</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2102</span>                         <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2103</span>                         <span class="n">skip_check_and_raise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2104</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>  <span class="c1"># Impossible :)</span>
<span class="g g-Whitespace">   </span><span class="mi">2105</span>         <span class="s1">&#39;_check_timeout(..., skip_check_and_raise=True) &#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">2106</span>         <span class="s1">&#39;failed to raise TimeoutExpired.&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2108</span> <span class="n">ready</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2109</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_timeout</span><span class="p">(</span><span class="n">endtime</span><span class="p">,</span> <span class="n">orig_timeout</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2111</span> <span class="c1"># XXX Rewrite these to use non-blocking I/O on the file</span>
<span class="g g-Whitespace">   </span><span class="mi">2112</span> <span class="c1"># objects; they are no longer using C stdio!</span>

<span class="nn">File ~/opt/anaconda3/envs/pymc_env/lib/python3.11/selectors.py:415,</span> in <span class="ni">_PollLikeSelector.select</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span> <span class="n">ready</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">415</span>     <span class="n">fd_event_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span> <span class="k">except</span> <span class="ne">InterruptedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span>     <span class="k">return</span> <span class="n">ready</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="n">RANDOM_SEED</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">RANDOM_SEED</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il modello di regressione multipla è un concetto fondamentale nell’ambito della statistica e dell’analisi dei dati. Si tratta di un’estensione del modello di regressione bivariato che permette di includere più predittori nel modello. Questo significa che, invece di considerare solo una variabile indipendente per predire una variabile dipendente, ora abbiamo più predittori.</p>
<p>Nel modello di regressione multipla, la variabile dipendente, che chiameremo <span class="math notranslate nohighlight">\(Y\)</span>, viene predetta prendendo in considerazione la presenza di variabili indipendenti, che chiameremo <span class="math notranslate nohighlight">\(X_1, X_2, \ldots, X_p\)</span>. Il modello assume che il valore atteso di <span class="math notranslate nohighlight">\(Y\)</span> condizionato alle variabili indipendenti può essere descritto da un’equazione lineare:</p>
<div class="math notranslate nohighlight">
\[Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \ldots + \beta_pX_p + \varepsilon.\]</div>
<p>In questa equazione, i coefficienti <span class="math notranslate nohighlight">\(\beta_0, \beta_1, \beta_2, \ldots, \beta_p\)</span> rappresentano i coefficienti parziali di regressione. Ogni <span class="math notranslate nohighlight">\(\beta_i\)</span> riflette la relazione tra la variabile dipendente <span class="math notranslate nohighlight">\(Y\)</span> e la variabile indipendente corrispondente <span class="math notranslate nohighlight">\(X_i\)</span>, considerando anche l’effetto delle altre variabili presenti nel modello.</p>
<p>Una differenza chiave rispetto al modello di regressione bivariato è nell’interpretazione dei coefficienti. Nel caso bivariato, il coefficiente <span class="math notranslate nohighlight">\(\beta_1\)</span> viene interpretato come il cambiamento atteso in <span class="math notranslate nohighlight">\(Y\)</span> al variare di una unità in <span class="math notranslate nohighlight">\(X_1\)</span>, mantenendo costanti tutte le altre variabili. Tuttavia, nel modello di regressione multipla, l’interpretazione di <span class="math notranslate nohighlight">\(\beta_1\)</span> cambia. In questo caso, <span class="math notranslate nohighlight">\(\beta_1\)</span> rappresenta il cambiamento atteso in <span class="math notranslate nohighlight">\(Y\)</span> al variare di una unità in <span class="math notranslate nohighlight">\(X_1\)</span>, mantenendo costanti gli effetti di tutte le altre variabili <span class="math notranslate nohighlight">\(X_2, X_3, \ldots, X_p\)</span>. In altre parole, <span class="math notranslate nohighlight">\(\beta_1\)</span> ci dice come varia <span class="math notranslate nohighlight">\(Y\)</span> quando <span class="math notranslate nohighlight">\(X_1\)</span> cambia, ma considera che le altre variabili possono anche variare con <span class="math notranslate nohighlight">\(X_1\)</span>, e <span class="math notranslate nohighlight">\(\beta_1\)</span> tiene conto di queste variazioni.</p>
<p>L’utilizzo del modello di regressione multipla ha principalmente due scopi. In primo luogo, è utilizzato per la predizione, cioè per ottenere la migliore stima possibile di <span class="math notranslate nohighlight">\(Y\)</span> utilizzando una combinazione lineare delle variabili <span class="math notranslate nohighlight">\(X_1, X_2, \ldots, X_p\)</span>. In questo contesto, i coefficienti <span class="math notranslate nohighlight">\(\beta_i\)</span> sono considerati come pesi che permettono di effettuare questa previsione.</p>
<p>In secondo luogo, il modello di regressione multipla viene spesso utilizzato per descrivere le relazioni causali tra le variabili, un’applicazione comune in psicologia. Tuttavia, è importante sottolineare che questo modello non è stato originariamente creato per stabilire relazioni causali, ed è necessario essere cauti nell’attribuire interpretazioni causali dirette ai coefficienti <span class="math notranslate nohighlight">\(\beta_i\)</span>. Questo perché il modello stima correttamente i coefficienti parziali di regressione solo quando tutte le variabili che influenzano <span class="math notranslate nohighlight">\(Y\)</span> sono incluse nel modello. Nella pratica, spesso non conosciamo tutte le variabili causalmente rilevanti, il che può portare a problemi di errore di specificazione.</p>
<p>In conclusione, il modello di regressione multipla è uno strumento potente per predire e descrivere le relazioni tra variabili, ma bisogna essere consapevoli delle sue limitazioni, in particolare quando si tratta di interpretazioni causali. Nella psicologia, dove la comprensione delle relazioni causali è fondamentale, è essenziale valutare attentamente le variabili da includere nel modello per evitare possibili distorsioni nelle stime dei coefficienti di regressione. Questo può essere particolarmente cruciale per sviluppare teorie solide e condurre ricerche empiriche affidabili.</p>
</section>
<section id="modello-di-regressione-e-analisi-causale">
<h2>Modello di Regressione e Analisi Causale<a class="headerlink" href="#modello-di-regressione-e-analisi-causale" title="Permalink to this heading">#</a></h2>
<p>Continuando con l’analisi del modello di regressione e dell’analisi causale, è essenziale approfondire come l’inclusione delle covariate nel modello multivariato possa influenzare la nostra interpretazione degli effetti causali. La questione centrale che dobbiamo affrontare è se l’aggiustamento per una covariata, che chiameremo <span class="math notranslate nohighlight">\(C\)</span>, possa rivelare l’effetto causale effettivo di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>Per comprendere meglio questo concetto, dobbiamo esaminare come la variabile dipendente <span class="math notranslate nohighlight">\(Y\)</span> varia in risposta a modifiche nella variabile indipendente <span class="math notranslate nohighlight">\(X\)</span>, tenendo conto della struttura causale presunta nel processo di generazione dei dati. La discussione che segue è basata su un articolo di riferimento di Lubke et al. [2020], che ci fornisce una solida base teorica.</p>
<p>Per illustrare questo concetto, consideriamo due tipi di strutture causalità. Nel primo caso, abbiamo una struttura a catena, rappresentata come <span class="math notranslate nohighlight">\(X \rightarrow C \rightarrow Y\)</span>, dove <span class="math notranslate nohighlight">\(X\)</span> causa <span class="math notranslate nohighlight">\(C\)</span> che a sua volta causa <span class="math notranslate nohighlight">\(Y\)</span>. In questa situazione, sarebbe inappropriato aggiustare per <span class="math notranslate nohighlight">\(C\)</span>, ossia condizionare su <span class="math notranslate nohighlight">\(C\)</span>, poiché <span class="math notranslate nohighlight">\(C\)</span> funge da mediatore nell’effetto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span>. Condizionare su <span class="math notranslate nohighlight">\(C\)</span> comporterebbe la rimozione di parte dell’effetto causale che intendiamo misurare.</p>
<p>Nel secondo caso, abbiamo una struttura a forcella, rappresentata come <span class="math notranslate nohighlight">\(X \leftarrow C \rightarrow Y\)</span>, in cui <span class="math notranslate nohighlight">\(C\)</span> è la causa comune di <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span>. In questa configurazione, è essenziale aggiustare per <span class="math notranslate nohighlight">\(C\)</span> al fine di rimuovere l’effetto confondente e isolare l’effetto diretto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>Il principio di base che guida questo approccio è che dobbiamo bloccare i percorsi non causali utilizzando la distribuzione condizionata e aprire i percorsi causali attraverso l’uso della distribuzione marginale. Questo ci aiuta a decidere quali covariate includere o escludere dal modello di regressione al fine di ottenere una stima più accurata dell’effetto causale.</p>
<p>Per chiarire ulteriormente questi concetti, utilizzeremo esempi simulati che mostrano chiaramente quando l’aggiustamento per determinate covariate è necessario per rivelare l’effetto causale reale e quando potrebbe portare a una distorsione nella nostra comprensione della relazione causale. Questa discussione è di particolare rilevanza nel campo della psicologia, dove la comprensione delle relazioni causali tra variabili è fondamentale per lo sviluppo di teorie solide e la conduzione di ricerche empiriche affidabili. La discussione che segue è stata ispirata dall’articolo di riferimento di <span id="id1">Lübke <em>et al.</em> [<a class="reference internal" href="../references/bibliography.html#id3" title="Karsten Lübke, Matthias Gehrke, Jörg Horst, and Gero Szepannek. Why we should teach causal inference: examples in linear regression with simulated data. Journal of Statistics Education, 28(2):133–139, 2020.">LubkeGHS20</a>]</span>.</p>
<section id="esempio-1-catena">
<h3>Esempio 1: Catena<a class="headerlink" href="#esempio-1-catena" title="Permalink to this heading">#</a></h3>
<p>Consideriamo le seguenti variabilili: apprendimento, conoscenza e comprensione. Iniziamo con l’apprendimento (<span class="math notranslate nohighlight">\(X\)</span>), il quale ha un effetto sull’acquisizione di conoscenza (<span class="math notranslate nohighlight">\(C\)</span>). Successivamente, la conoscenza a sua volta incide sulla comprensione (<span class="math notranslate nohighlight">\(Y\)</span>). È importante notare che la comprensione (“understanding”) è influenzata anche da fattori esterni (<span class="math notranslate nohighlight">\(U\)</span>), che in modelli di regressione vengono rappresentati tramite il termine di errore.</p>
<p>In situazioni reali, per valutare apprendimento, conoscenza e comprensione, è possibile utilizzare strumenti come questionari o misurazioni specifiche. Questi strumenti consentono di quantificare tali variabili per poterle poi analizzarle in contesti di ricerca.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">()</span>

<span class="c1"># Definizione dei nodi e degli archi</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Learning&quot;</span><span class="p">,</span> <span class="s2">&quot;Knowing&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Knowing&quot;</span><span class="p">,</span> <span class="s2">&quot;Understanding&quot;</span><span class="p">)</span>

<span class="c1"># Impostazione dell&#39;orientamento orizzontale</span>
<span class="n">f</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ee55e3a537e85c87fdc4a79da405b8b34c5c9a0884608b3eb47fa3c5e7116a83.svg" src="../_images/ee55e3a537e85c87fdc4a79da405b8b34c5c9a0884608b3eb47fa3c5e7116a83.svg" /></div>
</div>
<p>Simuliamo i dati in base a questa struttura causale.</p>
<div class="math notranslate nohighlight">
\[
X = UX, \quad UX \sim \mathcal{N}(0,1)
\]</div>
<div class="math notranslate nohighlight">
\[
C = 5 \cdot X + UC, \quad UC \sim \mathcal{N}(0,1)
\]</div>
<div class="math notranslate nohighlight">
\[
Y = 3 \cdot C + UY, \quad UY \sim \mathcal{N}(0,1)
\]</div>
<p>Dove <span class="math notranslate nohighlight">\(\mathcal{N}(\mu, \sigma)\)</span> indica la distribuzione Normale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># sample size</span>

<span class="c1"># Simulating the variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Learning</span>
<span class="n">C</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Knowing</span>
<span class="n">Y</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Understanding</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>C</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.301836</td>
      <td>4.170647</td>
      <td>13.286877</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.306395</td>
      <td>1.362525</td>
      <td>4.879558</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.716521</td>
      <td>4.426520</td>
      <td>13.593147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.316126</td>
      <td>-7.359503</td>
      <td>-21.171749</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.064074</td>
      <td>-0.305060</td>
      <td>-1.673014</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se non utilizziamo “knowing” come covariata nel modello di regressione, la stima dell’effetto di “learning” su “understanding” è priva di errore sistematico.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod1</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Y ~ X&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results1</span> <span class="o">=</span> <span class="n">mod1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results1</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.10</td>
      <td>0.11</td>
      <td>-0.11</td>
      <td>0.30</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4388.29</td>
      <td>2782.96</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>X</th>
      <td>14.98</td>
      <td>0.10</td>
      <td>14.79</td>
      <td>15.17</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4500.98</td>
      <td>2934.23</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Y_sigma</th>
      <td>3.30</td>
      <td>0.07</td>
      <td>3.16</td>
      <td>3.44</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3820.62</td>
      <td>2945.62</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ripetiamo ora l’analisi di regressione includeremo tutte le variabili nel modello. Questo è un approccio molto comune ed è stato chiamato “l’insalata causale” da <span id="id2">McElreath [<a class="reference internal" href="../references/bibliography.html#id112" title="Richard McElreath. Statistical rethinking: A Bayesian course with examples in R and Stan. CRC Press, Boca Raton, Florida, 2nd edition edition, 2020.">McE20</a>]</span>. L’idea alla base è che, includendo tutte le variabili nel modello di regressione, possiamo osservare l’effetto di X su Y dopo aver tenuto conto di tutte le altre variabili. Sembra ragionevole. Vediamo ora quanto bene funziona questo approccio nel caso presente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod2</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Y ~ X + C&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span> <span class="o">=</span> <span class="n">mod2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results2</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.03</td>
      <td>0.03</td>
      <td>-0.03</td>
      <td>0.09</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2506.64</td>
      <td>2175.98</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>X</th>
      <td>-0.34</td>
      <td>0.16</td>
      <td>-0.66</td>
      <td>-0.05</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1708.39</td>
      <td>1988.37</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>3.07</td>
      <td>0.03</td>
      <td>3.01</td>
      <td>3.13</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1718.43</td>
      <td>1964.64</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Y_sigma</th>
      <td>1.01</td>
      <td>0.02</td>
      <td>0.97</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2542.00</td>
      <td>2007.74</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se usiamo “knowing” come covariata nel modello di regressione, otteniamo una stima distorta dell’effetto di “learning” su “understanding”. Dato che abbiamo controllato per l’effetto del mediatore “knowing”, c’è un bias verso il basso dell’effetto totale di “learning” su “understanding”.</p>
<p>In conclusione, il condizionamento su un mediatore comporta una distorsione sistematica nei risultati.</p>
</section>
<section id="esempio-2-biforcazione">
<h3>Esempio 2: Biforcazione<a class="headerlink" href="#esempio-2-biforcazione" title="Permalink to this heading">#</a></h3>
<p>In questo secondo esempio, utilizzeremo le seguenti variabili simulate: l’intelligenza, il tempo di apprendimento e il punteggio del test. Il modello causale sottostante al processo di generazione dei dati è basato sulla premessa che l’intelligenza (<span class="math notranslate nohighlight">\(C\)</span>) influenzi positivamente il tempo di apprendimento (<span class="math notranslate nohighlight">\(X\)</span>). Inoltre, sia l’intelligenza (<span class="math notranslate nohighlight">\(C\)</span>) che il tempo di apprendimento (<span class="math notranslate nohighlight">\(X\)</span>), insieme a variabili esterne (<span class="math notranslate nohighlight">\(U\)</span>), concorrono a determinare il punteggio ottenuto nel test (<span class="math notranslate nohighlight">\(Y\)</span>). Per il nostro scopo, tralasciamo considerazioni relative a covariate aggiuntive, come la motivazione o l’interesse, e supponiamo che lo studente si dedichi esclusivamente al tempo (<span class="math notranslate nohighlight">\(X\)</span>) necessario per lo studio.</p>
<div class="math notranslate nohighlight">
\[
C = UC, \quad UC \sim \mathcal{N}(100, 15)
\]</div>
<div class="math notranslate nohighlight">
\[
X = 200 - C + UX, \quad UX \sim \mathcal{N}(0, 1)
\]</div>
<div class="math notranslate nohighlight">
\[
Y = 0.5 \cdot C + 0.1 \cdot X + UY, \quad UY \sim \mathcal{N}(0, 1)
\]</div>
<p>Dove <span class="math notranslate nohighlight">\(\mathcal{N}(\mu, \sigma)\)</span> indica la distribuzione Normale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">()</span>
<span class="k">with</span> <span class="n">f</span><span class="o">.</span><span class="n">subgraph</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;Learning Time&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;Test Score&quot;</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s2">&quot;Intelligence&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Intelligence&quot;</span><span class="p">,</span> <span class="s2">&quot;Learning Time&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Intelligence&quot;</span><span class="p">,</span> <span class="s2">&quot;Test Score&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Learning Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Test Score&quot;</span><span class="p">)</span>

<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/178870b7ee08bb1ed50da66d6296880dc4e9f7757b0ff3b4eedeafbc7e42b43b.svg" src="../_images/178870b7ee08bb1ed50da66d6296880dc4e9f7757b0ff3b4eedeafbc7e42b43b.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># sample size</span>

<span class="c1"># Simulating the variables</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Intelligence</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">-</span> <span class="n">I</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Learning Time</span>
<span class="n">S</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Test Score</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>I</th>
      <th>T</th>
      <th>S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>83.324648</td>
      <td>117.276553</td>
      <td>54.651733</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93.124550</td>
      <td>106.313668</td>
      <td>58.509989</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90.369131</td>
      <td>109.709534</td>
      <td>54.574878</td>
    </tr>
    <tr>
      <th>3</th>
      <td>114.486124</td>
      <td>86.902607</td>
      <td>65.711229</td>
    </tr>
    <tr>
      <th>4</th>
      <td>127.792436</td>
      <td>73.134242</td>
      <td>71.615555</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se il modello per la valutazione del punteggio del test non considera l’influenza dell’intelligenza, si può verificare un errore nella stima addirittura nella direzione dell’effetto vero di X (Tempo di Apprendimento) su Y (Punteggio del Test). Questo fenomeno è noto come il “paradosso di Simpson” <span id="id3">[<a class="reference internal" href="../references/bibliography.html#id26" title="Edward H Simpson. The interpretation of interaction in contingency tables. Journal of the Royal Statistical Society: Series B (Methodological), 13(2):238–241, 1951.">Sim51</a>]</span>, dove le relazioni tra le variabili possono invertirsi quando non si tiene conto di una variabile confondente come l’intelligenza.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod3</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;S ~ T&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results3</span> <span class="o">=</span> <span class="n">mod3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results3</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>99.66</td>
      <td>0.24</td>
      <td>99.18</td>
      <td>100.08</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5233.34</td>
      <td>3327.32</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>T</th>
      <td>-0.40</td>
      <td>0.00</td>
      <td>-0.40</td>
      <td>-0.39</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5376.63</td>
      <td>2963.86</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>S_sigma</th>
      <td>1.10</td>
      <td>0.02</td>
      <td>1.05</td>
      <td>1.14</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2750.98</td>
      <td>2610.12</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se condizioniamo sull’intelligenza, invece, l’effetto di “Learning Time” su “Test Score” viene stimato senza errori sistematici.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod4</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;S ~ T + I&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results4</span> <span class="o">=</span> <span class="n">mod4</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results4</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-11.58</td>
      <td>6.13</td>
      <td>-22.27</td>
      <td>0.66</td>
      <td>0.16</td>
      <td>0.11</td>
      <td>1463.13</td>
      <td>1893.61</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>T</th>
      <td>0.16</td>
      <td>0.03</td>
      <td>0.10</td>
      <td>0.21</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1468.10</td>
      <td>1889.96</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>I</th>
      <td>0.56</td>
      <td>0.03</td>
      <td>0.50</td>
      <td>0.61</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1460.60</td>
      <td>1855.97</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>S_sigma</th>
      <td>0.95</td>
      <td>0.02</td>
      <td>0.91</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2303.58</td>
      <td>1768.26</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Questo esempio evidenzia chiaramente che, senza considerare attentamente la struttura causale sottostante nel processo di generazione dei dati, diventa impossibile discernere se l’effetto di X su Y sia positivo o negativo. Per ottenere stime precise delle relazioni causali tra le variabili, è necessario incorporare la struttura causale del processo di generazione dei dati nel modello di regressione.</p>
</section>
<section id="esempio-3-il-condizionamento-produce-una-distorsione">
<h3>Esempio 3: Il Condizionamento Produce una Distorsione<a class="headerlink" href="#esempio-3-il-condizionamento-produce-una-distorsione" title="Permalink to this heading">#</a></h3>
<p>Il terzo esempio simulato illustra il fenomeno noto come il “paradosso di Berkson” (Berkson, 1946). Esaminiamo le seguenti variabili: la capacità di fare networking (X), la competenza (Y) e la promozione (C). In questo contesto, la capacità di fare networking (X) e la competenza (Y) sono tra loro indipendenti, ma la promozione (C) dipende da entrambe, oltre a essere influenzata da fattori esterni.</p>
<div class="math notranslate nohighlight">
\[
X = U_X, \quad U_X \sim \mathcal{N}(0, 1),
\]</div>
<div class="math notranslate nohighlight">
\[
Y = U_Y, \quad U_Y \sim \mathcal{N}(0, 1),
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde{C} \sim \begin{cases} 
1 &amp; \text{if } X &gt; 1 \text{ or } Y &gt; 1, \\
0 &amp; \text{altrimenti},
\end{cases}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
C = (1 - U_C) \cdot \tilde{C} + U_C \cdot (1 - \tilde{C}), \quad U_C \sim \text{Bernoulli}(0.05),
\]</div>
<p>dove <span class="math notranslate nohighlight">\(\text{Bernoulli}(\pi)\)</span> rappresenta la distribuzione di Bernoulli. In altre parole, qualcuno viene promosso – al di là della sua fortuna <span class="math notranslate nohighlight">\(U_C\)</span>, <span class="math notranslate nohighlight">\(\tilde{C}\)</span> = 1 – se la sua capacità di fare networking è elevata (X &gt; 1) o se la sua competenza è alta (Y &gt; 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sample Size</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">competence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="n">promotion</span> <span class="o">=</span> <span class="p">((</span><span class="n">network</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">competence</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">luck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">promotion</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">luck</span><span class="p">)</span> <span class="o">*</span> <span class="n">promotion</span> <span class="o">+</span> <span class="n">luck</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">promotion</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">promotion</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">network</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">competence</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P</th>
      <th>N</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.868291</td>
      <td>0.162798</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>-0.316309</td>
      <td>-0.416100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-1.179076</td>
      <td>-0.576754</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>-0.564320</td>
      <td>1.815324</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0.711427</td>
      <td>0.849024</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Competence&quot;</span><span class="p">,</span> <span class="s2">&quot;Promotion&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="s2">&quot;Ability to Network&quot;</span><span class="p">,</span> <span class="s2">&quot;Promotion&quot;</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d45d8c3dcb8dc8ef16a93c71204858c4385974ef28624fc9a3f6aa3536dc759d.svg" src="../_images/d45d8c3dcb8dc8ef16a93c71204858c4385974ef28624fc9a3f6aa3536dc759d.svg" /></div>
</div>
<p>Nel caso in cui non consideriamo la variabile di collusione “Promotion,” rileviamo in modo accurato solamente un modesto effetto della capacità di creare reti (X) sulla competenza (Y).</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod5</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;C ~ N&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results5</span> <span class="o">=</span> <span class="n">mod5</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results5</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-0.01</td>
      <td>0.03</td>
      <td>-0.07</td>
      <td>0.06</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4559.97</td>
      <td>2864.46</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>N</th>
      <td>0.02</td>
      <td>0.03</td>
      <td>-0.05</td>
      <td>0.08</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4319.43</td>
      <td>3350.54</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C_sigma</th>
      <td>1.03</td>
      <td>0.02</td>
      <td>0.99</td>
      <td>1.07</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4081.88</td>
      <td>3113.71</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Tuttavia, se interveniamo inappropriatamente, effettuando un aggiustamento per la promozione, emerge un effetto negativo della capacità di creare reti (X) sulla competenza (Y). Questo è un’associazione spuria.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod6</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;C ~ N + P&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results6</span> <span class="o">=</span> <span class="n">mod6</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results6</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-0.34</td>
      <td>0.04</td>
      <td>-0.41</td>
      <td>-0.28</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3856.14</td>
      <td>3143.74</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>N</th>
      <td>-0.17</td>
      <td>0.03</td>
      <td>-0.23</td>
      <td>-0.11</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3844.77</td>
      <td>2692.66</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>P</th>
      <td>1.08</td>
      <td>0.07</td>
      <td>0.94</td>
      <td>1.20</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4424.06</td>
      <td>3141.94</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C_sigma</th>
      <td>0.92</td>
      <td>0.02</td>
      <td>0.88</td>
      <td>0.96</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4345.71</td>
      <td>2965.80</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>È importante ricordare che nel processo di generazione dei dati, sia la competenza che l’abilità di creare reti influenzano la promozione. Tuttavia, nel modello precedente, abbiamo erroneamente eseguito una regressione della competenza sull’abilità di creare reti, senza tener conto del contesto causale. Questo approccio è particolarmente rischioso quando il collider (promozione) viene utilizzato come variabile di campionamento, ad esempio, quando selezioniamo solo individui che sono stati promossi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">only_promoted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod7</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;C ~ N&quot;</span><span class="p">,</span> <span class="n">only_promoted</span><span class="p">)</span>
<span class="n">results7</span> <span class="o">=</span> <span class="n">mod7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;nuts_numpyro&quot;</span><span class="p">,</span> <span class="n">idata_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">results7</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.82</td>
      <td>0.06</td>
      <td>0.71</td>
      <td>0.94</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4544.38</td>
      <td>2958.39</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>N</th>
      <td>-0.35</td>
      <td>0.05</td>
      <td>-0.45</td>
      <td>-0.25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4463.18</td>
      <td>3133.34</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C_sigma</th>
      <td>1.03</td>
      <td>0.04</td>
      <td>0.96</td>
      <td>1.11</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4255.51</td>
      <td>2957.02</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nell’analisi del modello presentato, si identifica un marcato effetto negativo tra la capacità di generare reti sociali e il livello di competenza. Questa correlazione negativa, tuttavia, rappresenta un’associazione spuria, emergente a causa della mancata considerazione del meccanismo generativo dei dati nel modello di regressione implementato.</p>
<p>Per illustrare la natura di questa associazione spuria, consideriamo il seguente scenario: se è noto che un individuo è stato promosso (variabile condizionante P) e si sa inoltre che tale individuo non eccelle nella creazione di reti (variabile indipendente X), si potrebbe inferire che tale individuo possiede un alto grado di competenza (variabile dipendente Y) – altrimenti non avrebbe ricevuto la promozione. In questa situazione, benché le variabili X (capacità di creare reti) e Y (competenza) siano intrinsecamente indipendenti, esse manifestano una dipendenza condizionale quando i dati sono condizionati sulla variabile P (la promozione). Di conseguenza, l’aggiustamento per la variabile P, attraverso tecniche di regressione o di campionamento stratificato (in questo caso, selezionando esclusivamente individui promossi), induce un’associazione spuria tra la capacità di creare reti (X) e la competenza (Y). Questo fenomeno evidenzia l’importanza di considerare il contesto e il processo generativo dei dati nella costruzione di modelli di regressione per evitare interpretazioni errate delle relazioni causali tra le variabili.</p>
</section>
</section>
<section id="considerazioni-conlusive">
<h2>Considerazioni Conlusive<a class="headerlink" href="#considerazioni-conlusive" title="Permalink to this heading">#</a></h2>
<p>Le simulazioni precedentemente condotte hanno evidenziato rilevanti implicazioni metodologiche, sollevando questioni cruciali riguardo l’adeguatezza dei modelli di regressione utilizzati. L’approccio tradizionale, che consiste nell’includere indiscriminatamente un vasto insieme di variabili nel modello di regressione, si è rivelato non solo insufficiente ma anche potenzialmente fuorviante. Tale pratica, motivata dalla speranza di ottenere un modello ottimale, non considera l’importanza fondamentale dell’analisi delle relazioni causali tra le variabili.</p>
<p>In particolare, l’inclusione non criteriata di covariate può portare alla formazione di associazioni spurie, compromettendo l’integrità e la validità dei risultati dell’analisi. Di conseguenza, è imperativo condurre un’analisi dettagliata e metodologicamente rigorosa delle relazioni causali tra le variabili interessate. Questo richiede un’attenta valutazione delle covariate da includere nel modello, basata non solo sulle osservazioni empiriche ma anche su una comprensione teorica del meccanismo generatore dei dati.</p>
<p>In questo contesto, la giustificazione del modello di regressione scelto diventa fondamentale. È essenziale che tale giustificazione sia radicata in una solida base teorica e sia supportata da evidenze empiriche. Ciò implica un’attenta considerazione dei meccanismi sottostanti che influenzano le variabili di interesse e la loro interazione. In ultima analisi, l’obiettivo è quello di costruire un modello di regressione che non solo si adatti bene ai dati a disposizione, ma che rispecchi anche accuratamente la realtà sottostante, evitando così il rischio di trarre conclusioni errate o fuorvianti.</p>
</section>
<section id="l-inferenza-causale-non-e-solo-un-problema-statistico">
<h2>L’inferenza causale non è solo un problema statistico<a class="headerlink" href="#l-inferenza-causale-non-e-solo-un-problema-statistico" title="Permalink to this heading">#</a></h2>
<p><span id="id4">D’Agostino McGowan <em>et al.</em> [<a class="reference internal" href="../references/bibliography.html#id2" title="Lucy D’Agostino McGowan, Travis Gerke, and Malcolm Barrett. Causal inference is not just a statistics problem. Journal of Statistics and Data Science Education, pages 1–6, 2024.">DAgostinoMGB24</a>]</span> propongono un <code class="docutils literal notranslate"><span class="pre">causal</span> <span class="pre">quartet</span></code> simile al quartetto di Anscombe. Il Quartetto di Anscombe è un insieme di quattro dataset che hanno le stesse proprietà statistiche (media, varianza, correlazione, ecc.) ma appaiono molto diversi quando rappresentati graficamente. Questo quartetto è spesso utilizzato per dimostrare l’importanza dell’analisi grafica dei dati, oltre all’analisi statistica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Caricare il dataset di Anscombe da seaborn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;anscombe&quot;</span><span class="p">)</span>

<span class="c1"># Creare una figura e un array di assi</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Disegnare ogni gruppo in un subplot diverso</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>]
    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataset </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>

<span class="c1"># Aggiustare lo spazio tra i grafici</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrare la figura</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/29673b5826156f09780efe3dba1453c9174fb27cd0fd7692a85838364cf63599.png" src="../_images/29673b5826156f09780efe3dba1453c9174fb27cd0fd7692a85838364cf63599.png" />
</div>
</div>
<p><span id="id5">D’Agostino McGowan <em>et al.</em> [<a class="reference internal" href="../references/bibliography.html#id2" title="Lucy D’Agostino McGowan, Travis Gerke, and Malcolm Barrett. Causal inference is not just a statistics problem. Journal of Statistics and Data Science Education, pages 1–6, 2024.">DAgostinoMGB24</a>]</span> propongono un quartetto differente in cui i sommari statistici non forniscono una comprensione del meccanismo sottostante, e neanche le visualizzazioni risolvono il problema. In questi esempi, è necessaria una comprensione o un’ipotesi sul meccanismo di generazione dei dati per catturare correttamente la relazione tra i fattori disponibili. Questo quartetto proposto può aiutare gli studenti a comprendere meglio le ipotesi alla base dei metodi di inferenza causale, sottolineando inoltre la necessità di acquisire una maggiore quantità di informazioni rispetto a quanto possa essere ottenuto attraverso l’uso esclusivo di strumenti statistici per stimare con precisione gli effetti causali.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Termine Tecnico</p></th>
<th class="head"><p>Spiegazione</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(1) Collider</p></td>
<td><p>La variabile <span class="math notranslate nohighlight">\(X\)</span>, causa <span class="math notranslate nohighlight">\(Z\)</span>, e l’esito, <span class="math notranslate nohighlight">\(Y\)</span>, causa <span class="math notranslate nohighlight">\(Z\)</span>. Aggiustando per <span class="math notranslate nohighlight">\(Z\)</span> quando si stima l’effetto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span> si ottiene un risultato distorto. Meccanismo di generazione dei dati: <span class="math notranslate nohighlight">\(X \sim \mathcal{N}(0,1)\)</span>, <span class="math notranslate nohighlight">\(Y = X + \varepsilon_y\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_y \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(Z = 0.45X + 0.77Y + \varepsilon_z\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_z \sim \mathcal{N}(0,1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>(2) Confounder</p></td>
<td><p>La variabile <span class="math notranslate nohighlight">\(Z\)</span> causa sia la variabile indipendente <span class="math notranslate nohighlight">\(X\)</span>, sia l’esito, <span class="math notranslate nohighlight">\(Y\)</span>. Non aggiustando per <span class="math notranslate nohighlight">\(Z\)</span> quando si stima l’effetto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span> si ottiene un risultato distorto. Meccanismo di generazione dei dati: <span class="math notranslate nohighlight">\(Z \sim \mathcal{N}(0,1)\)</span>, <span class="math notranslate nohighlight">\(X = Z + \varepsilon_x\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_x \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(Y = 0.5X + Z + \varepsilon_y\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_y \sim \mathcal{N}(0,1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>(3) Mediator</p></td>
<td><p>La variabile <span class="math notranslate nohighlight">\(X\)</span> causa <span class="math notranslate nohighlight">\(Z\)</span> che a sua volta causa l’esito <span class="math notranslate nohighlight">\(Y\)</span>. Aggiustando per <span class="math notranslate nohighlight">\(Z\)</span> quando si stima l’effetto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span> si ottiene l’effetto diretto, non aggiustando per <span class="math notranslate nohighlight">\(Z\)</span> si ottiene l’effetto totale di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span>. L’effetto diretto rappresenta la relazione tra <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> indipendentemente da qualsiasi mediatore, mentre l’effetto totale include sia l’effetto diretto sia qualsiasi effetto indiretto mediato dal mediatore potenziale. Meccanismo di generazione dei dati: <span class="math notranslate nohighlight">\(X \sim \mathcal{N}(0,1)\)</span>, <span class="math notranslate nohighlight">\(Z = X + \varepsilon_z\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_z \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(Y = Z + \varepsilon_y\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_y \sim \mathcal{N}(0,1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>(4) M-Bias</p></td>
<td><p>Ci sono due variabili aggiuntive, <span class="math notranslate nohighlight">\(U1\)</span> e <span class="math notranslate nohighlight">\(U2\)</span>. Entrambe causano <span class="math notranslate nohighlight">\(Z\)</span>, <span class="math notranslate nohighlight">\(U1\)</span> causa <span class="math notranslate nohighlight">\(X\)</span>, e <span class="math notranslate nohighlight">\(U2\)</span> causa l’esito <span class="math notranslate nohighlight">\(Y\)</span>. Aggiustando per <span class="math notranslate nohighlight">\(Z\)</span> quando si stima l’effetto di <span class="math notranslate nohighlight">\(X\)</span> su <span class="math notranslate nohighlight">\(Y\)</span> si ottiene un risultato distorto. Meccanismo di generazione dei dati: <span class="math notranslate nohighlight">\(U1 \sim \mathcal{N}(0,1)\)</span>, <span class="math notranslate nohighlight">\(U2 \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(Z = 8U1 + U2 + \varepsilon_z\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_z \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(X = U1 + \varepsilon_x\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_x \sim \mathcal{N}(0,1)\)</span>; <span class="math notranslate nohighlight">\(Y = X + U2 + \varepsilon_y\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_y \sim \mathcal{N}(0, 1)\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -n -u -v -iv -w -m
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The watermark extension is already loaded. To reload it, use:
  %reload_ext watermark
Last updated: Tue Jan 30 2024

Python implementation: CPython
Python version       : 3.11.7
IPython version      : 8.19.0

Compiler    : Clang 16.0.6 
OS          : Darwin
Release     : 23.3.0
Machine     : x86_64
Processor   : i386
CPU cores   : 8
Architecture: 64bit

Watermark: 2.4.3
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter_5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="05_reglin_4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Confronto tra le medie di due gruppi</p>
      </div>
    </a>
    <a class="right-next"
       href="E_causal_inference.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">✏️ Esercizi</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-del-notebook">Preparazione del Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-e-analisi-causale">Modello di Regressione e Analisi Causale</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-1-catena">Esempio 1: Catena</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-2-biforcazione">Esempio 2: Biforcazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#esempio-3-il-condizionamento-produce-una-distorsione">Esempio 3: Il Condizionamento Produce una Distorsione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conlusive">Considerazioni Conlusive</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#l-inferenza-causale-non-e-solo-un-problema-statistico">L’inferenza causale non è solo un problema statistico</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>